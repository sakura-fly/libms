<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>借阅情况</title>
    <script type="text/javascript" src="lib/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="lib/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="lib/css/bootstrap.min.css">
    <link rel="stylesheet" href="lib/layui/css/layui.css">
    <script type="text/javascript" src="lib/layui/layui.js"></script>
</head>
<body>
<div class="container">
    <table class="layui-table" id="bookfxt" lay-filter="bookfxt">
<span style="color: #ff0000;"></span>
    </table>
</div>
</body>
</html>
<script type="application/javascript">
    layui.use(["table"], function () {
        var table = layui.table
        userid = 1;
        table.render({
            elem: '#bookfxt',
            url: '/libms/ub/list',
            method: "post",
            where: {
                userid: userid
            },
            cols: [[
                {field: 'bookName', title: "书籍名称"},
                {
                    field: 'type', title: "借阅时间", templet: function (d) {
                        var ctime = new Date(d.bTime);
                        return ctime.getFullYear() + "年" + (ctime.getMonth() + 1) + "月" + ctime.getDate() + "日 ";


                    }
                },
                {
                    field: 'type', title: "预计归还时间", templet: function (d) {
                        var ctime = new Date(d.rTime)
                        return ctime.getFullYear() + "年" + (ctime.getMonth() + 1) + "月" + ctime.getDate() + "日 ";


                    }
                },
                {
                    field: 'type', title: "实际归还时间", templet: function (d) {
                        if (d.rtime) {
                            var ctime = new Date(d.rrTime)
                            return ctime.getFullYear() + "年" + (ctime.getMonth() + 1) + "月" + ctime.getDate() + "日 ";

                        } else {
                            return "尚未归还"
                        }


                    }
                },
                {
                    field: 'type', title: "距离归还剩余时间", templet: function (d) {
                        var btime = d.rTime;
                        var time = new Date().getTime();
                        var t = (btime - time) / 1000 / 60 / 60 / 24 ;
                        return (t > 0 ? "剩余" +  t  : "<span style=\"color: #ff0000;\">超出" + (-t) + "</span>") + "天";
                    }
                }
                // {field: 'num', title: '借阅次数'}
            ]],
            done: function (res, curr, count) {
                // tableData = res;
                // zbz = [];
                // zbdata = [];
                // for (var i in res.data) {
                //     zbz.push(res.data[i].type);
                //     zbdata.push(res.data[i].num);
                // }
            }

        });

    })
</script>